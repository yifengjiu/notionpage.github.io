<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>TCP三次握手四次挥手（包括序号和确认号机制）&nbsp;|&nbsp;沂风</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="TCP三次握手四次挥手（包括序号和确认号机制）">
  
    <meta name="description" content="详细介绍TCP三次握手与四次挥手，重点是序列号机制">
    <meta property="og:description" content="详细介绍TCP三次握手与四次挥手，重点是序列号机制">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;⚽&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>关于</span>
        </div>
      </a>
    
  
    
  
    
  
</nav>
  <header class="Header">
    
      <div class="Header__Cover">
        <img src="https://www.notion.so/images/page-cover/met_william_morris_1877_willow.jpg">
      </div>
    
    <div class="Header__Spacer ">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;⚽&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">TCP三次握手四次挥手（包括序号和确认号机制）</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Thu, Aug 24, 2023</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--green">
            <a href="tag/Web.html">Web</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/c6e0ff5f097b4a4c8a9e6e807ac26525" class="PageRoot"><h1 id="https://www.notion.so/a352c05928f444e5a2993b88552ad8ee" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/a352c05928f444e5a2993b88552ad8ee"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">TCP首部格式</span></span></h1><div id="https://www.notion.so/fa796d22f1194bf68b113cac5806a5af" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fbcc91a18-414b-42a2-85d2-7d1512f5e396%2FUntitled.png?width=1654&amp;table=block&amp;id=fa796d22-f119-4bf6-8b11-3cac5806a5af"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fbcc91a18-414b-42a2-85d2-7d1512f5e396%2FUntitled.png?width=1654&amp;table=block&amp;id=fa796d22-f119-4bf6-8b11-3cac5806a5af" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/213665be7ab642c68792d1f7a5421549" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">源端口 目的端口 序号 确认号</span></span></p></div><div id="https://www.notion.so/1f35161fde504a1885ef70ee2185a51e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">首部长度</span></span></p></div><div id="https://www.notion.so/ea4f59d5ce5c45499bb7a9b736539c73" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">ACK SYN等字段</span></span></p></div><div id="https://www.notion.so/f911f639ba5b46d78ef908ac2e16e6f1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">窗口</span></span></p></div><h1 id="https://www.notion.so/73ff88aad8404981af28c6fbf7a1732d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/73ff88aad8404981af28c6fbf7a1732d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">三次握手</span></span></h1><div id="https://www.notion.so/8055ab4129ff4ee182b5f574089bfb6d" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F901984de-7bcc-41de-8e6f-8c0094623126%2FUntitled.png?width=1508&amp;table=block&amp;id=8055ab41-29ff-4ee1-82b5-f574089bfb6d"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F901984de-7bcc-41de-8e6f-8c0094623126%2FUntitled.png?width=1508&amp;table=block&amp;id=8055ab41-29ff-4ee1-82b5-f574089bfb6d" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h2 id="https://www.notion.so/77275fcba73f4ae5907bf024db18c188" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/77275fcba73f4ae5907bf024db18c188"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">第一次</span></span></h2><div id="https://www.notion.so/1786ee9d518443148fad9e70b31c999e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">SYN=1 ACK=1  序号=x</span></span></p></div><h2 id="https://www.notion.so/a41b8d51995e489cac8348162eb4b0b8" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/a41b8d51995e489cac8348162eb4b0b8"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">第二次</span></span></h2><div id="https://www.notion.so/b5f87802243a4c0ea7b5f0aaeb23661d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">SYN=1 ACK=1序号=y 确认序号=x+1</span></span></p></div><h2 id="https://www.notion.so/98a6e0c54b204964a9c6b22bba2889b7" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/98a6e0c54b204964a9c6b22bba2889b7"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">第三次</span></span></h2><div id="https://www.notion.so/9291ddac1c9a4d06a7c2ceaeb4ad83a1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">SYN=0 ACK=1序号=x+1  确认序号=y+1</span></span></p></div><h3 id="https://www.notion.so/97dda866f76b463ba46b68a1589a9f24" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/97dda866f76b463ba46b68a1589a9f24"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">SYN -ACK SYN -ACk</span></span></h3><div id="https://www.notion.so/5ad50997ab2941bda8c989cb4ef83b04" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/a5b319d992054b73b98edaec8148865c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/18970e3267e343049705b20bd1a77a76" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/18970e3267e343049705b20bd1a77a76"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">三次握手的原因</span></span></h2><div id="https://www.notion.so/795845fe98924d23b024626230485cda" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">防止失效链接</span></span></p></div><div id="https://www.notion.so/a09728ff4bbb490cbcc66c4f0beef52d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">因为网络问题，晚些打到服务端的请求，不进行三次握手的话，就会使服务器产生额外一次错误的链接</span></span></p></div><div id="https://www.notion.so/be5cad9b778943e09164ffdc09d29665" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">三次握手会使客户端忽略第二次返回的服务端确认报文</span></span></p></div><div id="https://www.notion.so/34e52588d4564c91bbc9b016e3d45bbc" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F63f6a53d-84cb-4336-9dc1-11d0f1269f42%2FUntitled.png?width=1646&amp;table=block&amp;id=34e52588-d456-4c91-bbc9-b016e3d45bbc"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F63f6a53d-84cb-4336-9dc1-11d0f1269f42%2FUntitled.png?width=1646&amp;table=block&amp;id=34e52588-d456-4c91-bbc9-b016e3d45bbc" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/3e2183f68f6643ca992fb6a5b964d3a2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/f1585a6d85ba4892bd78ef9b3dc54f5f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h1 id="https://www.notion.so/61f98a280cde45ec940a925b50947458" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/61f98a280cde45ec940a925b50947458"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">四次挥手</span></span></h1><div id="https://www.notion.so/2ad5cbac451c4bb9bac4e7d79dfa1a61" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc1d1eff2-a78f-43f2-adc5-bfabea135e37%2FUntitled.png?width=1428&amp;table=block&amp;id=2ad5cbac-451c-4bb9-bac4-e7d79dfa1a61"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc1d1eff2-a78f-43f2-adc5-bfabea135e37%2FUntitled.png?width=1428&amp;table=block&amp;id=2ad5cbac-451c-4bb9-bac4-e7d79dfa1a61" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/0225016753ce41058f43b21d5d13f92f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">因为链接建立后ACK都为1，故不考虑ACK</span></span></p></div><h2 id="https://www.notion.so/33a5b7d75e0f4ae1b6444e67de6ab62e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/33a5b7d75e0f4ae1b6444e67de6ab62e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">第一次挥手</span></span></h2><div id="https://www.notion.so/50d542691b0e41f9af15c665adc5ba07" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">FIN seq=x</span></span></p></div><h2 id="https://www.notion.so/c4b4d05bba224d8ebf6e3447887d70aa" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/c4b4d05bba224d8ebf6e3447887d70aa"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">第二次</span></span></h2><div id="https://www.notion.so/dd686f1657a9440483ba25772be26918" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">服务端收到报文并确认，TCP链接处于半关闭状态</span></span></p></div><div id="https://www.notion.so/d0a2fc624d9144b79a7aa96ac2b1adfd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">seq=y ack=x+1</span></span></p></div><h2 id="https://www.notion.so/a1a24e71726347ca89fc60d8e26a55be" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/a1a24e71726347ca89fc60d8e26a55be"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">第三次</span></span></h2><div id="https://www.notion.so/caa7f0cd38be4e8ebc24e58a74664542" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"> 当 B 不再需要连接时，发送连接释放报文，FIN=1</span></span></p></div><div id="https://www.notion.so/126ffd21bd164cbc8dd51ae91a2593a4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">seq=a，ack=x+1</span></span></p></div><h2 id="https://www.notion.so/d46ce2b0bcff473580026e135020cce6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/d46ce2b0bcff473580026e135020cce6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">第四次</span></span></h2><div id="https://www.notion.so/78c6413455984b0dad1f34b79aef2dc8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">seq=x+1 qck=a+1</span></span></p></div><h3 id="https://www.notion.so/5d17c955c2ad408baa75f22c98259303" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/5d17c955c2ad408baa75f22c98259303"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">• A 收到后发出确认，进入 TIME-WAIT 状态，等待 2 MS，如果没收到重发，就结束链接</span></span></h3><h3 id="https://www.notion.so/21351d7ca720411f8bcbc9d22e14ad2f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/21351d7ca720411f8bcbc9d22e14ad2f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">FIN-ACK-FINACK-ACK</span></span></h3><h2 id="https://www.notion.so/1615d9a4f1964c79bb2c95eb3ae5183e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/1615d9a4f1964c79bb2c95eb3ae5183e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">四次挥手的原因</span></span></h2><div id="https://www.notion.so/ae2d4f7de3154cd1a20d24e7c0a9eb46" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">客户端发送了 FIN 连接释放报文之后，服务器收到了这</span></span></p></div><div id="https://www.notion.so/abd7aa1b3afa449fbff7d0564486ce53" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">四次挥手其实是比两次确认机制多了一次挥手，这个目的就是让服务器发送还未发送完的数据</span></span></p></div><h1 id="https://www.notion.so/17e643511bf14de7b97990e7b1cbef88" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/17e643511bf14de7b97990e7b1cbef88"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">序号机制</span></span></h1><div id="https://www.notion.so/191560d68c7241b29ae3d090f076ef5a" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fb67a4515-41f7-4212-b095-598550f94a8e%2FUntitled.png?width=1688&amp;table=block&amp;id=191560d6-8c72-41b2-9ae3-d090f076ef5a"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fb67a4515-41f7-4212-b095-598550f94a8e%2FUntitled.png?width=1688&amp;table=block&amp;id=191560d6-8c72-41b2-9ae3-d090f076ef5a" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/7a2ac4ffe4104d8da66b2f007a3cc3f6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">TCP 协议为了实现可靠传输， 通信双方需要判断自己已经发送的数据包是否都被接收方收到， 如果没收到， 就需要重发。 为了实现这个需求， 很自然地就会引出序号（sequence number） 和 确认号（acknowledgement number） 的使用。</span></span></p></div><div id="https://www.notion.so/d0b30cadfdcf4ba7816623a2385ef521" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">序列号：在建立连接时由计算机生成的随机数作为其初始值，通过 SYN 包传给接收端主机，每发送一次数据，就累加一次该数据字节数的大小。用来解决网络包乱序问题。
确认号：指下一次期望收到的数据的序列号，发送端收到这个确认应答以后可以认为在这个序号以前的数据都已经被正常接收。用来解决不丢包的问题。</span></span></p></div><h2 id="https://www.notion.so/9a9d289105744604974352ab0cc1f259" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/9a9d289105744604974352ab0cc1f259"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">举例</span></span></h2><div id="https://www.notion.so/1e98065ecbdf4f08bf7c9bb228d955c4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">客户端在发送数据包，假设大小为  10byte时， 假设上一个序列号为，那么服务端收到这个数据包以后， 就会回复一个确认号210（参考上面的计算方法：服务器端的确认号是上一个客户端的序列号+负载数据，） ，告诉客户端我已经收到了序列号209截止到的数据，期待的下一个数据起点是210。</span></span></p></div><div id="https://www.notion.so/fa9831b87684438d8a03ec05c84d4884" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">SYN syn=200  SYNACK ack=210 syn=x ACK ack=x+1 syn=210 </span></span></p></div><h3 id="https://www.notion.so/b464c298dd5d4af28341148c89e2b041" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/b464c298dd5d4af28341148c89e2b041"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">因为链接和断开过程中的包不包括数据，所以+1</span></span></h3><h1 id="https://www.notion.so/63de06b8c0bd4919beb11d54e0e4171a" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/63de06b8c0bd4919beb11d54e0e4171a"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">具体实验</span></span></h1><h2 id="https://www.notion.so/db44806d3b954c5d8b9b2cecb6cf5f0a" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/db44806d3b954c5d8b9b2cecb6cf5f0a"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">三次握手过程</span></span></h2><div id="https://www.notion.so/38259701e54049e2983f3c1e75326aa4" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F07f3ae8b-99b2-4fbd-8332-2b46d48ed8ff%2FUntitled.png?width=1069&amp;table=block&amp;id=38259701-e540-49e2-983f-3c1e75326aa4"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F07f3ae8b-99b2-4fbd-8332-2b46d48ed8ff%2FUntitled.png?width=1069&amp;table=block&amp;id=38259701-e540-49e2-983f-3c1e75326aa4" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/0f9b50d12016471b82132d0ef764a8fc" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">首先A向B发一个SYN包，告诉B请求建立连接。seq为初始化的随机值（如何初始化和系统具体实现有关），这里假设为10000，此时ACK序号为0。</span></span></li><li id="https://www.notion.so/e97142d9c3b54f9cb7ac1c2f785ef2a3" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">B收到后会发一个对SYN包的确认包(SYN+ACK)回去，表示对第一个SYN包的确认，并继续握手操作。此时B也以一个随机值来初始化seq（与A无关），这里假设为20000。B的ACK是A的seq加1，即10000＋1＝10001。表示你的请求我已收到，我这方的序号就从20000开始，由于你的syn包消耗了1字节，我期望下一个收到的序列号从10001开始。</span></span></li><li id="https://www.notion.so/986e773c3e2046bb9368ff4c533d9e51" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">A收到SYN+ACK 包后回一个确认包(ACK)通知B连接已建立。它的seq是上个请求（①）的seq加1，即10000＋1＝10001，当然也等于上一个包（②）的ACK，ACK是B的seq加1，即20000+1=20001，用于确认收到②（syn被置位，所以也消耗了1字节）。</span></span></li></ol><h2 id="https://www.notion.so/7f5898e31eb941b48a98c8d266753182" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/7f5898e31eb941b48a98c8d266753182"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">数据传输阶段</span></span></h2><div id="https://www.notion.so/9c9393405c814477a084ae71b30bf140" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fed2cc598-9e14-4bff-834a-e927e7957f40%2FUntitled.png?width=1015&amp;table=block&amp;id=9c939340-5c81-4477-a084-ae71b30bf140"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fed2cc598-9e14-4bff-834a-e927e7957f40%2FUntitled.png?width=1015&amp;table=block&amp;id=9c939340-5c81-4477-a084-ae71b30bf140" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/22943fac5a344eabbae75fd729797e39" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">A发起Get请求，由于上一个③的len=0，且没有syn或fin标志，因此没有消耗seq的值，seq不变还是10001。ACK序号确认的还是上一个收到的②（这段期间也没有收到新的包）。</span></span></li><li id="https://www.notion.so/57800cdad7314ee2861b38363550b1c1" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">B对收到的④发出回应，告诉A我已经收到。由于上一个请求②消耗了1字节，这里seq为20001。ACK为④的seq+len=10001+183=10184。</span></span></li><li id="https://www.notion.so/5d1367746cf04d5988619beffd34b2f6" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">B发送200ok，由于⑤长度为0没有消耗seq，这里seq仍然为20001，ACK序号确认的还是上一个收到的④。</span></span></li></ol><h2 id="https://www.notion.so/69ded3836d484a8ba71a401f55237e10" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/69ded3836d484a8ba71a401f55237e10"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">四次挥手</span></span></h2><div id="https://www.notion.so/9d1a0c7f3e254f0797e2c82db02141b9" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3d26082f-824f-4e7a-bfec-4c17d14c26df%2FUntitled.png?width=1025&amp;table=block&amp;id=9d1a0c7f-3e25-4f07-97e2-c82db02141b9"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3d26082f-824f-4e7a-bfec-4c17d14c26df%2FUntitled.png?width=1025&amp;table=block&amp;id=9d1a0c7f-3e25-4f07-97e2-c82db02141b9" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/3e7c0b3f27a74ae3b7516b0cd2c3dc81" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">⑦ 确认⑥，并发出挥手。</span></span></p></div><div id="https://www.notion.so/f032bd4e6b944de3b22b503faa7a6b23" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">⑧ 确认⑦，并发出挥手。⑦长度0，但是有FIN标志，消耗1字节，ACK=10184+1=10185。</span></span></p></div><div id="https://www.notion.so/f6b65098a68b4823a76624c64c72555e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">⑨ 确认⑧，虽然⑧长度为0，但是有FIN标志，消耗1字节，ACK=20155+1=20156。至此挥手完成，TCP整个生命周期结束。</span></span></p></div><div id="https://www.notion.so/61854d2cfb89415fb11a919ed1ee8992" class="Bookmark"><a href="https://www.cnblogs.com/realjimmy/p/12930797.html#:~:text=①~③为三次握手，④~⑥为数据传送阶段，⑦~⑨为四次挥手过程（这里实际只有三个包，因为⑧结合了fin和ack两个步骤）。,我们看第一个包的seq和ack都是0，这是wireshark为了方便阅读将序号重0开始计算（没有改变实际值），我们看到有字段里有两个带RAW的字段，它们才是序号真实的值。"><h5 class="Bookmark__Title">TCP三次握四次挥手里seq和ack号的【正确】理解 - 一觉醒来写程序 - 博客园</h5><p class="Bookmark__Desc">1 理论知识先上一张图，TCP/IP详解第18章的这张图描述了一个正常的三次握手和四次挥手的状态迁移，以及seq、ack序号的变化。基本状态看图就能了解，本文主要围绕序号的变化进行讲解。1）seq序号seq的初始值在不同系统实现不一样，一般为随时间增长的值。当seq超过4字节存储空间后从0开始。在某</p><p class="Bookmark__Link">https://www.cnblogs.com/realjimmy/p/12930797.html#:~:text=①~③为三次握手，④~⑥为数据传送阶段，⑦~⑨为四次挥手过程（这里实际只有三个包，因为⑧结合了fin和ack两个步骤）。,我们看第一个包的seq和ack都是0，这是wireshark为了方便阅读将序号重0开始计算（没有改变实际值），我们看到有字段里有两个带RAW的字段，它们才是序号真实的值。</p></a></div><div id="https://www.notion.so/53126d6b905444ea997c82b4ddab957a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></article>
  <footer class="Footer">
  <div>&copy; 沂风 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>