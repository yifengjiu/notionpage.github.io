<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>new String和直接赋值的区别，包括JVM中的情况&nbsp;|&nbsp;沂风</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="new String和直接赋值的区别，包括JVM中的情况">
  
    <meta name="description" content="面试题，仔细研究下">
    <meta property="og:description" content="面试题，仔细研究下">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🪢&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>关于</span>
        </div>
      </a>
    
  
</nav>
  <header class="Header">
    
      <div class="Header__Cover">
        <img src="https://www.notion.so/images/page-cover/webb4.jpg">
      </div>
    
    <div class="Header__Spacer ">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🪢&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">new String和直接赋值的区别，包括JVM中的情况</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Thu, Sep 21, 2023</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--brown">
            <a href="tag/JVM.html">JVM</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/0f3e867e961d4f4293e1fe0ee8b70dc4" class="PageRoot"><ul id="https://www.notion.so/51b4f8a8dc1c46138aab23922c5d6a06" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/e9df4c8865094db09f67c67a0bd60e8d"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">主要区别</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/e939f7259d8d467bb91a680c852a1bf0"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">String str1=&quot;ABC&quot; 可能创建一个对象或者不创建对象，如果&quot;ABC&quot;这个字符串在java String池里不存在，会在java String池创建这个一个String对象(&quot;ABC&quot;).如果已经存在，str1直接reference to 这个String池里的对象。</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/d84293380a764a15bc8322b541dd2ef3"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">String str2 = new String(&quot;ABC&quot;) 至少创建一个对象，也可能两个。因为用到new 关键字，会在heap创建一个 str2 的String 对象，它的value 是 &quot;ABC&quot;.同时，如果&quot;ABC&quot;这个字符串在java String池里不存在，会在java String池创建这个一个String对象(&quot;ABC&quot;)（估计引用的就是这个堆中的独享了）</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7d19960c1aac474e9b57212b7ec20bcd"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">public String intern()返回字符串对象的规范化表示形式。</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/8840471bf81f4392bd7819d7773631df"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">本地方法</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">intern()</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/541f6a7323814495a1ac27305e7ff987"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">具体使用</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/d25d3a65360a400095240bf76c1c7126"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">new String(&quot;a&quot;) 创建几个对象？</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/d622cb23af104bd6ad3a8538b862c016"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">new String(&quot;a&quot;) + new String(&quot;b&quot;) 创建几个对象？</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/1fcd99b0981e4933ad2df2b62b042a74"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">场景分析</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/5476d0d1d4dd49cabe95fca5ee3fb9ed"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">具体分析</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/017045152d9044fa82931c3df4e418eb"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">
a和b都是字符串常量所以在编译期就被确定了！
而c中有个b是引用不是字符串常量所以不会在编译期确定。
而String是final的！所以在b+&quot;c&quot;的时候实际上是新创建了一个对象，然后在把新创建对象的引用传给c</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/b7d92a08d0a54fc4bb5560e0dfc05de2"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">只要其中有一个是变量，结果就在堆中。变量拼接的原理是StringBuilder</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/71af39a4bd0b4d1fb37d50e58299f975"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">字符串常量池</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/0bb12a9ee3074a4aa830f8dc7dac3565"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">• 为了减少在jvm中创建的字符串的数量，虚拟机维护了一个字符串常量池</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/8f3bb042ec93474683a7bf6e347588b7"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">位置改动</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/6e1ead6f632b4a63a606c5664599cac2"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">• </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">字符串常量池是一个固定大小的Hashtable</strong></em></span><span class="SemanticString">。如果放进String Poo1的String非常多， 就会造成Hash冲突严重，从而导致链表会很长，而链表长了后直接会造成的影响就是当调用String.intern时性能会大幅下降。</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/452bfc6df6ab4178802ad8b5fd2cf7b8"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">字符串常量池的垃圾回收</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7777bc9247054718a428ea0dfaeccd32"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">参考资料</span></span></div></a></li></ul><h1 id="https://www.notion.so/e9df4c8865094db09f67c67a0bd60e8d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/e9df4c8865094db09f67c67a0bd60e8d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">主要区别</span></span></h1><div id="https://www.notion.so/a03d2bc583f24553b32cc5b5a52979fc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">String str1=&quot;ABC&quot;； 和String str2 = new String(&quot;ABC&quot;);</span></span></p></div><h3 id="https://www.notion.so/e939f7259d8d467bb91a680c852a1bf0" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/e939f7259d8d467bb91a680c852a1bf0"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">String str1=&quot;ABC&quot; 可能创建一个对象或者不创建对象，如果&quot;ABC&quot;这个字符串在java String池里不存在，会在java String池创建这个一个String对象(&quot;ABC&quot;).如果已经存在，str1直接reference to 这个String池里的对象。</strong></span></span></h3><h3 id="https://www.notion.so/d84293380a764a15bc8322b541dd2ef3" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/d84293380a764a15bc8322b541dd2ef3"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">String str2 = new String(&quot;ABC&quot;) 至少创建一个对象，也可能两个。因为用到new 关键字，会在heap创建一个 str2 的String 对象，它的value 是 &quot;ABC&quot;.同时，如果&quot;ABC&quot;这个字符串在java String池里不存在，会在java String池创建这个一个String对象(&quot;ABC&quot;)（估计引用的就是这个堆中的独享了）</span></span></h3><div id="https://www.notion.so/1eaff0145b3a4ff985b9551ed95d473a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">使用的是String提供的intern()方法，通过字面量的方式(区别于new，在堆中)给一个字符串赋值，此时的字符串值声明在字符串常量池中。</span></span></p></div><h3 id="https://www.notion.so/7d19960c1aac474e9b57212b7ec20bcd" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/7d19960c1aac474e9b57212b7ec20bcd"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">public String intern()返回字符串对象的规范化表示形式。</strong></span></span></h3><div id="https://www.notion.so/2b161e60bd6845cb908c9124f78e3022" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">一个初始时为空的字符串池，它由类 String 私有地维护。</strong></span></span></p></div><div id="https://www.notion.so/db0009931d7947a987e8db5c01a90130" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">当调用 intern 方法时，如果池已经包含一个等于此 String 对象的字符串（该对象由 equals(Object) 方法确定），则返回池中的字符串。否则，将此 String 对象添加到池中，并且返回此 String 对象的引用。</span></span></p></div><div id="https://www.notion.so/fc31cf8a88c4468588e24dd4168dd78b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">它遵循对于任何两个字符串 s 和 t，当且仅当 s.equals(t) 为 true 时，s.intern() == t.intern() 才为 true。</span></span></p></div><h1 id="https://www.notion.so/8840471bf81f4392bd7819d7773631df" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/8840471bf81f4392bd7819d7773631df"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">本地方法</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">intern()</strong></span></span></h1><div id="https://www.notion.so/14f147b591514b1180cbfdacbd7195ca" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">intern方法会从字符串常量池中查询当前字符串是否存在：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/d36e686d789943f4bf2c1537800399c4" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">若不存在就会将当前字符串放入常量池中，并返回当地字符串地址引用。</span></span></li><li id="https://www.notion.so/361026c03e844a4baa418c93cc16c339" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果存在就返回字符串常量池那个字符串地址</span></span></li></ul><pre id="https://www.notion.so/f60c5819e0d84136b916ef247b8a5b8b" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token class-name">String</span> myInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"I love you"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span></span></code></pre><h2 id="https://www.notion.so/541f6a7323814495a1ac27305e7ff987" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/541f6a7323814495a1ac27305e7ff987"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">具体使用</span></span></h2><h3 id="https://www.notion.so/d25d3a65360a400095240bf76c1c7126" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/d25d3a65360a400095240bf76c1c7126"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">new String(&quot;a&quot;) 创建几个对象？</strong></span></span></h3><div id="https://www.notion.so/e87425facf0147dab470e864f4b191c7" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F97f60ed7-2f91-4328-9e16-bcc075d7c8a7%2F46a0a209-01f0-4287-8102-b9938e1eda08%2FUntitled.png?width=1544&amp;table=block&amp;id=e87425fa-cf01-47da-b470-e864f4b191c7"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F97f60ed7-2f91-4328-9e16-bcc075d7c8a7%2F46a0a209-01f0-4287-8102-b9938e1eda08%2FUntitled.png?width=1544&amp;table=block&amp;id=e87425fa-cf01-47da-b470-e864f4b191c7" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/b2d4e30463ce477dadd93cbce6e9c881" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">ldc:把字符串放到字符串常量池 </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://link.juejin.cn/?target=https%3A%2F%2Fdocs.oracle.com%2Fjavase%2Fspecs%2Fjvms%2Fse16%2Fhtml%2Fjvms-6.html%23jvms-6.5.ldc">字节码命令查看网址</a></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/0de716a00e5042b895cffe39d9a4d8dc" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">对象1：new关键字在堆空间创建的字符串对象</span></span></li><li id="https://www.notion.so/393de88dd2774fce9c491eeefe6609f5" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">对象2：字符串常量池中的对象&quot;ab&quot;。</span></span></li></ul><h3 id="https://www.notion.so/d622cb23af104bd6ad3a8538b862c016" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/d622cb23af104bd6ad3a8538b862c016"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">new String(&quot;a&quot;) + new String(&quot;b&quot;) 创建几个对象？</span></span></h3><div id="https://www.notion.so/d64c23630a84432cabd14e80628681a1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对象1：new StringBuilder()</span></span></p></div><div id="https://www.notion.so/8a06f06846ac4d92bc6704b3cea966c5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对象2： new String(&quot;a&quot;)</span></span></p></div><div id="https://www.notion.so/03c5b52388ef43c08b497923756aa11c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对象3： 常量池中的&quot;a&quot;</span></span></p></div><div id="https://www.notion.so/c941a9d46f96484881b8689d7fa126f2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对象4： new String(&quot;b&quot;)</span></span></p></div><div id="https://www.notion.so/a5fab5851d224f62889314ee695fed3a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对象5： 常量池中的&quot;b&quot;</span></span></p></div><div id="https://www.notion.so/123c02964bd1405fb45da78f3cc290e2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">对象6 ：new String(&quot;ab&quot;) （深入剖析： StringBuilder的toString()相当于： 变量=“ab” ;new String(变量)，在字符串常量池中，没有生成&quot;ab&quot;）</span></span></p></div><h2 id="https://www.notion.so/1fcd99b0981e4933ad2df2b62b042a74" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/1fcd99b0981e4933ad2df2b62b042a74"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">场景分析</span></span></h2><pre id="https://www.notion.so/60750e5431604b6da2874c4c0f4d597b" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringExer1</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
            <span class="token comment">//new String("ab") 执行完以后，字符串常量池中并没有"ab"</span>
            <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">//jdk6中：在串池中创建一个字符串"ab"</span>
            <span class="token comment">//jdk8中：字符串池中没有创建字符串"ab",而是创建一个引用，指向new String("ab")，将此引用返回</span>
            <span class="token class-name">String</span> s2 <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s2 <span class="token operator">==</span> <span class="token string">"ab"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//jdk6:true  jdk8:true</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s <span class="token operator">==</span> <span class="token string">"ab"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//jdk6:false  jdk8:true</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s <span class="token operator">==</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//jdk8:true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/44d842f211344ea6925d3c3c375cb1c9" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F97f60ed7-2f91-4328-9e16-bcc075d7c8a7%2F44aa3bbe-7183-4437-bfb0-f29b96d5c078%2FUntitled.png?width=1530&amp;table=block&amp;id=44d842f2-1134-4ea6-925d-3c3c375cb1c9"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F97f60ed7-2f91-4328-9e16-bcc075d7c8a7%2F44aa3bbe-7183-4437-bfb0-f29b96d5c078%2FUntitled.png?width=1530&amp;table=block&amp;id=44d842f2-1134-4ea6-925d-3c3c375cb1c9" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/65b69f465e1049dc83cb611c42dc4f8f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在字符串池中创建一个引用，引用指向堆中的对象，并将引用返回</span></span></p></div><h1 id="https://www.notion.so/5476d0d1d4dd49cabe95fca5ee3fb9ed" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/5476d0d1d4dd49cabe95fca5ee3fb9ed"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">具体分析</span></span></h1><div id="https://www.notion.so/acbb427bc6494e71aff4a3a7f264569c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">String str1 = new String(&quot;ABC&quot;);</span><span class="SemanticString">String str2 = new String(&quot;ABC&quot;);</span></span></p></div><div id="https://www.notion.so/f700079716c344899e689b924e2ca3ae" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">str1 == str2 的值是True 还是False呢？ False.</span></span></p></div><div id="https://www.notion.so/fa7ea91a32404c4d808d6e91563068fd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/a0960a71f1a04237883d1fd614ecfc45" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/ca1e970d3bcf4a8297aba3fd57bc3951" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">String str3 = &quot;ABC&quot;;
String str4 = &quot;ABC&quot;;
String str5 = &quot;A&quot; + &quot;BC&quot;;
str3 == str4 的值是True 还是False呢？ True.
str3 == str5 的值是True 还是False呢？ True.
</span></span></p></div><div id="https://www.notion.so/2919760d33124ad4846deb191b5460ac" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/90533e1d7b6d4c1db7f9adf3210276e6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">String a = &quot;ABC&quot;;
String b=&quot;AB&quot;;
String c=b+&quot;C&quot;;
System.out.println(a==c); false</span></span></p></div><h3 id="https://www.notion.so/017045152d9044fa82931c3df4e418eb" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/017045152d9044fa82931c3df4e418eb"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">
a和b都是字符串常量所以在编译期就被确定了！
而c中有个b是引用不是字符串常量所以不会在编译期确定。
而String是final的！所以在b+&quot;c&quot;的时候实际上是新创建了一个对象，然后在把新创建对象的引用传给c</span></span></h3><div id="https://www.notion.so/effaf99277864821a77dbfc84530808d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/9c26efbaed084ae9b172b73caf39d29f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h3 id="https://www.notion.so/b7d92a08d0a54fc4bb5560e0dfc05de2" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/b7d92a08d0a54fc4bb5560e0dfc05de2"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">只要其中有一个是变量，结果就在堆中。变量拼接的原理是StringBuilder</span></span></h3><pre id="https://www.notion.so/be53c8238aea4478bfabe8087f62fb75" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token string">"a"</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token string">"ab"</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> s4 <span class="token operator">=</span> s1 <span class="token operator">+</span> s2<span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3 <span class="token operator">==</span> s4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//false</span>
        <span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/b11eba2d0c59458784ec672006be9136" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如下的s1 + s2 的底层执行过程：(变量s是我临时定义的）</span></span></p></div><div id="https://www.notion.so/b993c78a90614909a64e478d0023d8b2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">1 StringBuilder s = new StringBuilder();</span></span></p></div><div id="https://www.notion.so/42db3203456246cf9d907bea0dc13125" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">2 s.append(&quot;a&quot;)</span></span></p></div><div id="https://www.notion.so/5c8170cfd4214f7fa705039e0401893f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">3 s.append(&quot;b&quot;)</span></span></p></div><div id="https://www.notion.so/35c43539fdda4a65a45050dc36453c58" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">4 s.toString() （注意这里： 约等于 new String(&quot;ab&quot;)</span></span></p></div><div id="https://www.notion.so/15f61843facd4d01a3c865c2af854782" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">补充：在jdk5.0之后使用的是StringBuilder,在jdk5.0之前使用的是StringBuffer
</span></span></p></div><div id="https://www.notion.so/8c5afc7e1f52446ab9948d90fe9e2b74" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/f868c763eaad4985a41485d19459077d" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//字面量+字面量</span>
            <span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token string">"a"</span> <span class="token operator">+</span> <span class="token string">"b"</span> <span class="token operator">+</span> <span class="token string">"c"</span><span class="token punctuation">;</span><span class="token comment">//javac编译器在编译期优化了：等同于"abc"</span>
            <span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span> <span class="token comment">//"abc"一定是放在字符串常量池中，将此地址赋给s2</span>
            <span class="token comment">/*
             * 最终.java编译成.class,再执行.class
             * String s1 = "abc";
             * String s2 = "abc"
             */</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1 <span class="token operator">==</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
        <span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/50bf713ffd8f413b9e79263767e66f5f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/a5446ceb350041698514136cc5e42985" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/80ad1d2ce4fa4e50b0e16ef8842c7337" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">• 常量+常量（字面量）（final 修饰字符串）</span></span></p></div><pre id="https://www.notion.so/abc0fc66618a44d9ac0eb394f8aa73dc" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">final</span> <span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token string">"a"</span><span class="token punctuation">;</span>
            <span class="token keyword">final</span> <span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token string">"ab"</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> s4 <span class="token operator">=</span> s1 <span class="token operator">+</span> s2<span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3 <span class="token operator">==</span> s4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
        <span class="token punctuation">}</span>
</span></span></span></code></pre><div id="https://www.notion.so/ecc2e3aed97548908852539e7e0e5656" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/88a6cde0c59348218ee6ba885a5e3e57" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">字符串拼接操作+底层不一定使用的是StringBuilder! </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">如果拼接符号左右两边都是字符串常量或常量引用，则仍然使用编译期优化，即非StringBuilder的方式。</strong></em></span></span></p></div><h1 id="https://www.notion.so/71af39a4bd0b4d1fb37d50e58299f975" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/71af39a4bd0b4d1fb37d50e58299f975"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">字符串常量池</span></span></h1><h3 id="https://www.notion.so/0bb12a9ee3074a4aa830f8dc7dac3565" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/0bb12a9ee3074a4aa830f8dc7dac3565"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">• 为了减少在jvm中创建的字符串的数量，虚拟机维护了一个字符串常量池</span></span></h3><div id="https://www.notion.so/c2461535d2214a17a6150c00796a8063" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">•当创建String对象时，jvm会先检查字符串常量池，如果这个字符串的常量值已经存在在池中了，就直接返回池中对象的引用，如果不在池中，就会实例化一个字符串并放入池中</span></span></p></div><h2 id="https://www.notion.so/8f3bb042ec93474683a7bf6e347588b7" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/8f3bb042ec93474683a7bf6e347588b7"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">位置改动</span></span></h2><div id="https://www.notion.so/ac4f716042a1461aaef456e5709ae70d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">• Java6及以前，字符串常量池存放在永久代。</span></span></p></div><div id="https://www.notion.so/a20b8e5c809248d787a39f8c1fd9c46f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Java7中Oracle的工程师对字符串池的逻辑做了很大的改变，即将字符串常量池的位置调整到Java堆内。</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/25cb01af30a34d44b116d03274840baa" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">所有的字符串都保存在堆(Heap)中，和其他普通对象一 样，这样可以让你在进行调优应用时仅需要调整堆大小就可以了。</span></span></li><li id="https://www.notion.so/d489aa23c66147bf8410c2ccc7748840" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">字符串常量池概念原本使用得比较多，但是这个改动使得我们有足够的理由让我们重新考虑在Java7中使用String.intern()。</span></span></li></ul><div id="https://www.notion.so/2772a6843cfc4e2280256332c82c3cd1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">• Java8元空间，字符串常量在堆。</span></span></p></div><div id="https://www.notion.so/7ca7dd4526d845c7a7ca4931f6ca8066" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">• String在jdk8及以前内部定义了final char [] value用于存储字符串数据。jdk9时改为byte[]</span></span></p></div><h3 id="https://www.notion.so/6e1ead6f632b4a63a606c5664599cac2" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/6e1ead6f632b4a63a606c5664599cac2"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">• </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">字符串常量池是一个固定大小的Hashtable</strong></em></span><span class="SemanticString">。如果放进String Poo1的String非常多， 就会造成Hash冲突严重，从而导致链表会很长，而链表长了后直接会造成的影响就是当调用String.intern时性能会大幅下降。</span></span></h3><div id="https://www.notion.so/1e43013a2c4a4115a1b376266ba3f832" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F97f60ed7-2f91-4328-9e16-bcc075d7c8a7%2F1f43de37-313b-45a0-80be-9813ed3129a6%2FUntitled.png?width=1552&amp;table=block&amp;id=1e43013a-2c4a-4115-a1b3-76266ba3f832"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F97f60ed7-2f91-4328-9e16-bcc075d7c8a7%2F1f43de37-313b-45a0-80be-9813ed3129a6%2FUntitled.png?width=1552&amp;table=block&amp;id=1e43013a-2c4a-4115-a1b3-76266ba3f832" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h2 id="https://www.notion.so/452bfc6df6ab4178802ad8b5fd2cf7b8" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/452bfc6df6ab4178802ad8b5fd2cf7b8"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">字符串常量池的垃圾回收</span></span></h2><div id="https://www.notion.so/f4aee01b3ea24bd49da129cf96db09ab" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h1 id="https://www.notion.so/7777bc9247054718a428ea0dfaeccd32" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/7777bc9247054718a428ea0dfaeccd32"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">参考资料</span></span></h1><div id="https://www.notion.so/c8c8eeca22704b9281f318a36acdb43d" class="Bookmark"><a href="https://juejin.cn/post/6995715596092440584"><h5 class="Bookmark__Title">深入理解JVM（八）一一 字符串常量池 - 掘金</h5><p class="Bookmark__Desc">深入理解JVM（八）一一 字符串常量池 前言 字符串常量池也叫StringTable,String Intern Pool 为了减少在jvm中创建的字符串的数量，虚拟机维护了一个字符串常量池 当创建</p><p class="Bookmark__Link">https://juejin.cn/post/6995715596092440584</p></a></div></article>
  <footer class="Footer">
  <div>&copy; 沂风 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>