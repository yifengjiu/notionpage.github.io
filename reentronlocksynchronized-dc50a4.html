<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>ReentronLock与synchronized的区别与选择&nbsp;|&nbsp;沂风</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="ReentronLock与synchronized的区别与选择">
  
    <meta name="description" content="两种锁的适用场景">
    <meta property="og:description" content="两种锁的适用场景">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🕜&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>关于</span>
        </div>
      </a>
    
  
</nav>
  <header class="Header">
    
      <div class="Header__Cover">
        <img src="https://www.notion.so/images/page-cover/nasa_transonic_tunnel.jpg">
      </div>
    
    <div class="Header__Spacer ">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🕜&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">ReentronLock与synchronized的区别与选择</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Mon, Sep 11, 2023</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--red">
            <a href="tag/JUC.html">JUC</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/dc50a4d7b66b45d989df44be5def8b99" class="PageRoot"><ul id="https://www.notion.so/fbf218da14db4aab967a86326665fcb4" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/ab8b6571fab744069f578af4ac655e47"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">关键句：</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/5bcbcefc015f48999cf5909fdff6e639"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">后续java在一次次的版本迭代中 对 Synchronized 进行了大量的优化，直到 jdk1.6 之后，两种锁的性能已经相差无几，甚至 Synchronized 的自动释放锁会更好用。</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/93c04b4f1ba84e89be3dc9b46520c64b"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">Synchronized与ReentronLock的基本使用（补充版）</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/3cba6d05028445d1a7af45247ad1c2fe"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Synchronized</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/60b3f812bc094bef9f04aaa55ed689d9"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">线程会去先抢对象的监视器</strong></span><span class="SemanticString"> ，这个监视器是对象独有的</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/46d2d9a7f2bb47b49c0641fc01afd889"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">SynchronizedQueue 是一个比较特殊的队列，它没有存储功能，它的功能就是维护一组线程,其中每个插入操作必须等待另一个线程的移除操作，同样任何一个移除操作都等待另一个线程的插入操作。</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/6145215b26cd452d939d5be8aa61ceb4"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">锁升级与重量级锁的黑历史</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/6231295f3c9f41ea843a9efef5d95c59"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">每一次锁的资源都是直接和 cpu 去申请的，而 cpu 的锁数量是固定的 ，当 cpu 锁资源使用完后还会进行锁等待，这是一个非常耗时的操作。</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/c33b4ccb7fda4cdfb911ff8fe2aa9c3b"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">锁优化锁升级过程，就是尽量避免向CPU申请锁的情况</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/3e9cd594fb374329a2a08d53614030fd"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">同时，syn包含锁降级过程，但仅仅会发生在STW时刻</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/0fbbf308ca204c9e95d3149882200a3e"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">ReentronLock</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/bcc33aab84f343a499f0ae45fd949dd9"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">与Synchronized的不同是，锁需要手动释放</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/6f30fab474ae4af88160a099eb9e8aba"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">为了保证一定释放，所以通常都是和 try~finally 配合使用的。</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/0ce30756c7484103b3968985b0fda263"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">AQS锁框架（大概）</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/a42b88ad82564f39bd6bc47f4c683ab1"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">AQS使用state来标注资源的状态，并且仅提供getState，setState以及CAS操作，这是一种封装的思想</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/b4cb6e0a435748e998cbb18583df0fb0"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">当有线程获取锁失败后，AQS是通过一个 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">双向的同步队列</strong></span><span class="SemanticString"> 来完成同步状态的管理,就被添加到队列末尾。</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ca447135bde448e280521810a58f95ce"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">主要区别</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/c93793a97afe4c068b4c2d8fde80c7c2"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">ReentrantLock和Synchronized </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">最核心的区别就在于</strong></span><span class="SemanticString"> Synchronized适合于并发竞争低的情况，因为Synchronized的锁升级如果最终升级为重量级锁在使用的过程中是没有办法消除的，意味着每次都要和cpu去请求锁资源，而ReentrantLock主要是提供了阻塞的能力， </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">通过在高并发下线程的挂起，来减少竞争，提高并发能力</strong></span><span class="SemanticString"></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7cb373d7be8148859a06b441b1c01e65"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">重点是Syn会锁升级，Reen高并发情况是相对稳定的</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/3f5106289afe4e9da7658e52bba6c467"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">synchronized是隐式锁，可以 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">自动释放锁</strong></span><span class="SemanticString"> ，ReentrantLock是显式锁，需要 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">手动释放锁</strong></span><span class="SemanticString"> 。</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/23ad0b57622a42228a04bd27aade7b66"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">synchronized是一个关键字，是由 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">jvm层面</strong></span><span class="SemanticString"> 去实现的，而ReentrantLock是由 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">java api</strong></span><span class="SemanticString"> 去实现的。</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/f8767784c7a34207a72e8e8928472996"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">ReentrantLock可以获取锁状态，而synchronized不能。</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7aeb9f3ce8a84b52b11c00fc72420c72"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">答案</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/12eb98a326b845469dd02b34bbc30f40"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">ReentranLock对锁的控制更全面（syn是隐式锁）</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/f816379246fc4137a9c919cc93927784"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">Syn锁有升级过程，最后会升级成重量级锁，且一般不会降级。相应的，ReentronLock锁中的双向队列会通过阻塞线程的方式实现锁的功能</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7ac1530f7202443e8ca8ad4a0fbd6b8d"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">相应的使用场景：在资源竞争不是很激烈的情况下，偶尔会有同步的情形下，synchronized是很合适的。原因在于，编译程序通常会尽可能的进行优化</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/5c6d69a13fe54074aff19dc214697e90"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">由于ReentrantLock但是当同步非常激烈的时候，还能维持常态。所以比较适合高并发的场景。</span></span></div></a></li></ul><h1 id="https://www.notion.so/ab8b6571fab744069f578af4ac655e47" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/ab8b6571fab744069f578af4ac655e47"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">关键句：</span></span></h1><h3 id="https://www.notion.so/5bcbcefc015f48999cf5909fdff6e639" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/5bcbcefc015f48999cf5909fdff6e639"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">后续java在一次次的版本迭代中 对 Synchronized 进行了大量的优化，直到 jdk1.6 之后，两种锁的性能已经相差无几，甚至 Synchronized 的自动释放锁会更好用。</span></span></h3><h1 id="https://www.notion.so/93c04b4f1ba84e89be3dc9b46520c64b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/93c04b4f1ba84e89be3dc9b46520c64b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Synchronized与ReentronLock的基本使用（补充版）</span></span></h1><h2 id="https://www.notion.so/3cba6d05028445d1a7af45247ad1c2fe" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/3cba6d05028445d1a7af45247ad1c2fe"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Synchronized</span></span></h2><h3 id="https://www.notion.so/60b3f812bc094bef9f04aaa55ed689d9" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/60b3f812bc094bef9f04aaa55ed689d9"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">线程会去先抢对象的监视器</strong></span><span class="SemanticString"> ，这个监视器是对象独有的</span></span></h3><h3 id="https://www.notion.so/46d2d9a7f2bb47b49c0641fc01afd889" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/46d2d9a7f2bb47b49c0641fc01afd889"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">SynchronizedQueue 是一个比较特殊的队列，它没有存储功能，它的功能就是维护一组线程,其中每个插入操作必须等待另一个线程的移除操作，同样任何一个移除操作都等待另一个线程的插入操作。</span></span></h3><h3 id="https://www.notion.so/6145215b26cd452d939d5be8aa61ceb4" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/6145215b26cd452d939d5be8aa61ceb4"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">锁升级与重量级锁的黑历史</span></span></h3><div id="https://www.notion.so/332e4b828772492ebe33502a54adf87e" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F97f60ed7-2f91-4328-9e16-bcc075d7c8a7%2F85abe14f-6eba-4905-890a-02c1bc130097%2FUntitled.png?width=1040&amp;table=block&amp;id=332e4b82-8772-492e-be33-502a54adf87e"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2F97f60ed7-2f91-4328-9e16-bcc075d7c8a7%2F85abe14f-6eba-4905-890a-02c1bc130097%2FUntitled.png?width=1040&amp;table=block&amp;id=332e4b82-8772-492e-be33-502a54adf87e" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h3 id="https://www.notion.so/6231295f3c9f41ea843a9efef5d95c59" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/6231295f3c9f41ea843a9efef5d95c59"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">每一次锁的资源都是直接和 cpu 去申请的，而 cpu 的锁数量是固定的 ，当 cpu 锁资源使用完后还会进行锁等待，这是一个非常耗时的操作。</span></span></h3><h3 id="https://www.notion.so/c33b4ccb7fda4cdfb911ff8fe2aa9c3b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/c33b4ccb7fda4cdfb911ff8fe2aa9c3b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">锁优化锁升级过程，就是尽量避免向CPU申请锁的情况</span></span></h3><h3 id="https://www.notion.so/3e9cd594fb374329a2a08d53614030fd" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/3e9cd594fb374329a2a08d53614030fd"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">同时，syn包含锁降级过程，但仅仅会发生在STW时刻</span></span></h3><h2 id="https://www.notion.so/0fbbf308ca204c9e95d3149882200a3e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/0fbbf308ca204c9e95d3149882200a3e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">ReentronLock</span></span></h2><h3 id="https://www.notion.so/bcc33aab84f343a499f0ae45fd949dd9" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/bcc33aab84f343a499f0ae45fd949dd9"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">与Synchronized的不同是，锁需要手动释放</span></span></h3><h3 id="https://www.notion.so/6f30fab474ae4af88160a099eb9e8aba" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/6f30fab474ae4af88160a099eb9e8aba"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">为了保证一定释放，所以通常都是和 try~finally 配合使用的。</span></span></h3><h3 id="https://www.notion.so/0ce30756c7484103b3968985b0fda263" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/0ce30756c7484103b3968985b0fda263"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">AQS锁框架（大概）</span></span></h3><ol class="NumberedListWrapper"><li id="https://www.notion.so/bf7ae7bd05bb4c2ab5a2e88c51db3aec" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">获取state状态，查看占用情况</span></span></li><li id="https://www.notion.so/0e5a5d1c51784759ab01524f13415ecc" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">对state进行处理，并实现锁重入过程</span></span></li><li id="https://www.notion.so/a2ffa071ce3346198c5081b1961b4da3" class="NumberedList" value="3"><span class="SemanticStringArray"><span class="SemanticString">非公平锁，会多一个CAS操作的过程</span></span></li></ol><h3 id="https://www.notion.so/a42b88ad82564f39bd6bc47f4c683ab1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/a42b88ad82564f39bd6bc47f4c683ab1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">AQS使用state来标注资源的状态，并且仅提供getState，setState以及CAS操作，这是一种封装的思想</span></span></h3><h3 id="https://www.notion.so/b4cb6e0a435748e998cbb18583df0fb0" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/b4cb6e0a435748e998cbb18583df0fb0"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">当有线程获取锁失败后，AQS是通过一个 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">双向的同步队列</strong></span><span class="SemanticString"> 来完成同步状态的管理,就被添加到队列末尾。</span></span></h3><h1 id="https://www.notion.so/ca447135bde448e280521810a58f95ce" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/ca447135bde448e280521810a58f95ce"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">主要区别</span></span></h1><h3 id="https://www.notion.so/c93793a97afe4c068b4c2d8fde80c7c2" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/c93793a97afe4c068b4c2d8fde80c7c2"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">ReentrantLock和Synchronized </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">最核心的区别就在于</strong></span><span class="SemanticString"> Synchronized适合于并发竞争低的情况，因为Synchronized的锁升级如果最终升级为重量级锁在使用的过程中是没有办法消除的，意味着每次都要和cpu去请求锁资源，而ReentrantLock主要是提供了阻塞的能力， </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">通过在高并发下线程的挂起，来减少竞争，提高并发能力</strong></span><span class="SemanticString"></span></span></h3><h3 id="https://www.notion.so/7cb373d7be8148859a06b441b1c01e65" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/7cb373d7be8148859a06b441b1c01e65"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">重点是Syn会锁升级，Reen高并发情况是相对稳定的</span></span></h3><h3 id="https://www.notion.so/3f5106289afe4e9da7658e52bba6c467" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/3f5106289afe4e9da7658e52bba6c467"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">synchronized是隐式锁，可以 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">自动释放锁</strong></span><span class="SemanticString"> ，ReentrantLock是显式锁，需要 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">手动释放锁</strong></span><span class="SemanticString"> 。</span></span></h3><h3 id="https://www.notion.so/23ad0b57622a42228a04bd27aade7b66" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/23ad0b57622a42228a04bd27aade7b66"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">synchronized是一个关键字，是由 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">jvm层面</strong></span><span class="SemanticString"> 去实现的，而ReentrantLock是由 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">java api</strong></span><span class="SemanticString"> 去实现的。</span></span></h3><h3 id="https://www.notion.so/f8767784c7a34207a72e8e8928472996" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/f8767784c7a34207a72e8e8928472996"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">ReentrantLock可以获取锁状态，而synchronized不能。</span></span></h3><h1 id="https://www.notion.so/7aeb9f3ce8a84b52b11c00fc72420c72" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/7aeb9f3ce8a84b52b11c00fc72420c72"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">答案</span></span></h1><h2 id="https://www.notion.so/12eb98a326b845469dd02b34bbc30f40" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/12eb98a326b845469dd02b34bbc30f40"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">ReentranLock对锁的控制更全面（syn是隐式锁）</span></span></h2><h2 id="https://www.notion.so/f816379246fc4137a9c919cc93927784" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/f816379246fc4137a9c919cc93927784"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Syn锁有升级过程，最后会升级成重量级锁，且一般不会降级。相应的，ReentronLock锁中的双向队列会通过阻塞线程的方式实现锁的功能</span></span></h2><h2 id="https://www.notion.so/7ac1530f7202443e8ca8ad4a0fbd6b8d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/7ac1530f7202443e8ca8ad4a0fbd6b8d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">相应的使用场景：在资源竞争不是很激烈的情况下，偶尔会有同步的情形下，synchronized是很合适的。原因在于，编译程序通常会尽可能的进行优化</span></span></h2><h2 id="https://www.notion.so/5c6d69a13fe54074aff19dc214697e90" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/5c6d69a13fe54074aff19dc214697e90"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">由于ReentrantLock但是当同步非常激烈的时候，还能维持常态。所以比较适合高并发的场景。</span></span></h2></article>
  <footer class="Footer">
  <div>&copy; 沂风 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>